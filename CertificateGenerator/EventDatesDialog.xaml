<Window x:Class="CertificateGenerator.EventDatesDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Dátumy podujatí" 
        MinHeight="650" 
        Width="850"
        FontSize="14"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        Background="{StaticResource BackgroundColor}">

    <Grid Margin="25,5,25,10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
                <TextBlock Text="Priraďte dátumy k témam podujatí" 
                           FontSize="13" Padding="20,5,1,10"
                           FontWeight="DemiBold"
                           Foreground="{StaticResource TextPrimaryColor}"
                           HorizontalAlignment="Left"/>

                <!-- Quick Actions -->
        <Border Grid.Row="1" 
                Style="{StaticResource Card}" 
                Margin="0,0,0,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Margin="0,0,15,0">

                    <Label Content="Nastaviť všetkým rovnaký dátum:" 
                           Style="{StaticResource ModernLabel}"/>
                    <DatePicker x:Name="DtpCommonDate" 
                                Style="{StaticResource ModernDatePicker}"
                                SelectedDateFormat="Short"/>
                </StackPanel>

                <Button Grid.Column="1" 
                        Content="✓ Aplikovať na všetky" 
                        Style="{StaticResource SuccessButton}"
                        Padding="17,10" 
                        FontSize="14"
                        x:Name="SameDateForEveryCertificatesButton"
                        VerticalAlignment="Bottom"
                        Click="ApplyCommonDate_Click"/>
            </Grid>
        </Border>

        <!-- Auto-fill Dates Section -->
        <Border Grid.Row="2" 
                Style="{StaticResource Card}" 
                Margin="0,0,0,20">
            <StackPanel>
                <Label Content="🔄 Automatické vyplnenie dátumov" 
                       Style="{StaticResource ModernLabel}"
                       FontSize="15"
                       FontWeight="Bold"
                       Margin="0,0,0,10"/>

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                        <Label Content="Počiatočný dátum:" 
                               Style="{StaticResource ModernLabel}"/>
                        <DatePicker x:Name="DtpAutoStartDate" 
                                    Style="{StaticResource ModernDatePicker}"
                                    SelectedDateFormat="Short"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1" Margin="0,0,10,0">
                        <Label Content="Pravidlo:" 
                               Style="{StaticResource ModernLabel}"/>
                        <ComboBox x:Name="CmbDateRule" 
                                  Style="{StaticResource ModernComboBox}"
                                  SelectedIndex="0">
                            <ComboBoxItem Content="Prvý pondelok v mesiaci"/>
                            <ComboBoxItem Content="Prvý utorok v mesiaci"/>
                            <ComboBoxItem Content="Prvý štvrtok v mesiaci"/>
                            <ComboBoxItem Content="Prvý piatok v mesiaci"/>
                            <ComboBoxItem Content="Posledný piatok v mesiaci"/>
                            <ComboBoxItem Content="15. deň v mesiaci"/>
                            <ComboBoxItem Content="Prvý deň v mesiaci"/>
                            <ComboBoxItem Content="Každý týždeň (+7 dní)"/>
                            <ComboBoxItem Content="Každé 2 týždne (+14 dní)"/>
                        </ComboBox>
                    </StackPanel>

                    <Button Grid.Column="2" 
                            Content="🔄 Aplikovať pravidlo" 
                            Style="{StaticResource SuccessButton}"
                            Padding="15,10" 
                            FontSize="14"
                            VerticalAlignment="Bottom"
                            Click="AutoFillDates_Click"/>
                </Grid>
            </StackPanel>
        </Border>

        <!-- DataGrid with Topics and Dates -->
        <Border Grid.Row="3" 
                Style="{StaticResource Card}" 
                Margin="0,0,0,20">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Label Grid.Row="0"
                       Content="📋 Témy a ich dátumy"
                       Style="{StaticResource ModernLabel}"
                       FontSize="15"
                       FontWeight="Bold"
                       Margin="0,0,0,15"/>

                <Border Grid.Row="1"
                        BorderThickness="1"
                        BorderBrush="{StaticResource BorderColor}"
                        CornerRadius="6"
                        Background="{StaticResource SurfaceColor}">
                    <DataGrid x:Name="DgEventTopics"
                              Style="{StaticResource ModernDataGrid}"
                              BorderThickness="0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Poradie" 
                                            Binding="{Binding Index}" 
                                            Width="80"
                                            IsReadOnly="True"/>
                            <DataGridTextColumn Header="Téma podujatia" 
                                            Binding="{Binding Topic}" 
                                            Width="*"
                                            IsReadOnly="True"/>
                            <DataGridTemplateColumn Header="Dátum podujatia" Width="220">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DatePicker SelectedDate="{Binding EventDate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Style="{StaticResource ModernDatePicker}"
                                                SelectedDateFormat="Short"
                                                Margin="4"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
            </Grid>
        </Border>

        <!-- Buttons -->
        <StackPanel Grid.Row="4" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Center">
            <Button Content="✓ Pokračovať" 
                    Style="{StaticResource SuccessButton}"
                    Width="150" 
                    Height="48"
                    FontSize="15"
                    FontWeight="Bold"
                    Margin="0,0,15,0"
                    IsDefault="True"
                    Click="Continue_Click"/>
            <Button Content="✖️ Zrušiť" 
                    Style="{StaticResource SecondaryButton}"
                    Width="120" 
                    Height="48"
                    FontSize="15"
                    IsCancel="True"
                    Click="Cancel_Click"/>
        </StackPanel>
    </Grid>
</Window>
