<Window x:Class="CertificateGenerator.BulkGenerationWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Hromadné generovanie certifikátov" 
        MinHeight="800" 
        Width="1100"
        FontSize="14"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        Background="{StaticResource BackgroundColor}">

    <ScrollViewer 
        HorizontalScrollBarVisibility="Auto"
        VerticalScrollBarVisibility="Auto">

    <Grid Margin="30" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" 
                Style="{StaticResource Card}" 
                Margin="0,0,0,20">
            <StackPanel>
                <TextBlock Text="Hromadné generovanie PDF certifikátov" 
                           FontSize="20"
                           FontWeight="Bold"
                           Foreground="{StaticResource TextPrimaryColor}"
                           HorizontalAlignment="Center"/>
            </StackPanel>
        </Border>

        <!-- Common Data Section -->
        <Border Grid.Row="1" 
                Style="{StaticResource Card}" 
                Margin="0,0,0,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="3*"/>
                </Grid.ColumnDefinitions>

                <!-- Left Column -->
                <StackPanel Grid.Column="0" Margin="0,0,20,0">
                    <Label Content="⚙️ Spoločné údaje"
                           Style="{StaticResource ModernLabel}"
                           FontSize="16"
                           FontWeight="Bold"
                           Margin="0,0,0,15"/>

                    <Label Content="Organizátor:" Style="{StaticResource ModernLabel}"/>
                    <TextBox x:Name="TxtBulkOrganizer" 
                             Text=""
                             Style="{StaticResource ModernTextBox}"
                             Margin="0,0,0,15"/>

                    <Label Content="Formát papiera:" Style="{StaticResource ModernLabel}"/>
                    <ComboBox x:Name="CmbBulkPaperFormat" 
                              Style="{StaticResource ModernComboBox}">
                        <ComboBoxItem Content="A3 (297 × 420 mm)" />
                        <ComboBoxItem Content="A4 (210 × 297 mm)" />
                        <ComboBoxItem Content="A5 (148 × 210 mm)" IsSelected="True"/>
                    </ComboBox>
                </StackPanel>

                <!-- Right Column - Topics and Dates -->
                <Border Grid.Column="1" 
                        Background="{StaticResource InputBackground}"
                        CornerRadius="8"
                        Padding="15">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Row="0"
                               Content="📋 Témy podujatí a dátumy"
                               Style="{StaticResource ModernLabel}"
                               FontSize="16"
                               FontWeight="Bold"
                               Margin="0,0,0,10"/>

                        <!-- Instructions -->
                        <TextBlock Grid.Row="1" 
                                   TextWrapping="Wrap" 
                                   Margin="0,0,0,10"
                                   Foreground="{StaticResource TextSecondaryColor}"
                                   FontSize="12"
                                   Text="Vložte témy podujatí (každá na nový riadok, alebo oddelené čiarkou/bodkočiarkou). Pre každú tému sa vytvorí samostatný certifikát." />

                        <!-- Topics TextBox -->
                        <TextBox Grid.Row="2"
                                 x:Name="TxtBulkTopics" 
                                 Style="{StaticResource ModernTextBox}"
                                 Height="Auto"
                                 MinHeight="120"
                                 TextWrapping="Wrap" 
                                 AcceptsReturn="True"
                                 VerticalScrollBarVisibility="Auto"
                                 Padding="12,10"
                                 Margin="0,0,0,10"
                                 TextChanged="TxtBulkTopics_TextChanged"/>

                        <!-- Topics Counter -->
                        <Border Grid.Row="3"
                                Background="{StaticResource SurfaceColor}"
                                CornerRadius="6"
                                Padding="12,8">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <TextBlock Text="Počet tém: " FontWeight="SemiBold"/>
                                <TextBlock x:Name="TxtTopicsCount" Text="0" 
                                           Foreground="{StaticResource PrimaryColor}" 
                                           FontWeight="Bold"/>
                                <TextBlock Text=" → " Margin="10,0" FontWeight="Bold"/>
                                <TextBlock Text="Bude vytvorených " />
                                <TextBlock x:Name="TxtPdfCount" Text="0" 
                                           Foreground="{StaticResource SuccessColor}" 
                                           FontWeight="Bold"/>
                                <TextBlock Text=" PDF súborov"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>
            </Grid>
        </Border>

        <!-- Participants List Section -->
        <Border Grid.Row="2" 
                Style="{StaticResource Card}" 
                Margin="0,0,0,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="49*"/>
                    <ColumnDefinition Width="284*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Label Grid.Row="0"
                       Content="👥 Zoznam účastníkov"
                       Style="{StaticResource ModernLabel}"
                       FontSize="16"
                       FontWeight="Bold"
                       Margin="0,0,0,15" Grid.ColumnSpan="2"/>

                <!-- Toolbar -->
                <WrapPanel 
                           Orientation="Horizontal" 
                           Margin="0,46,0,180" Grid.ColumnSpan="2" Grid.RowSpan="2">
                    <Button Content="➕ Pridať" 
                            Style="{StaticResource SuccessButton}"
                            Width="110" 
                            
                            FontSize="13"
                            Padding="15,8"
                            Margin="0,0,8,8"
                            Click="AddParticipant_Click"/>
                        <Button Content="Vybrať uložené" 
                            Style="{StaticResource SuccessButton}"
                            Width="110" 
                            x:Name="SelectFromDBButton"
                            FontSize="13"
                            Padding="15,8"
                            Margin="0,0,8,8"
                            Click=" "/>
                        <Button Content="✏️ Upraviť" 
                            Style="{StaticResource ModernButton}"
                            Width="110" 
                            
                            FontSize="13"
                            Padding="15,8"
                            Margin="0,0,8,8"
                            Click="EditParticipant_Click"/>
                    <Button Content="🗑️ Odstrániť" 
                            Style="{StaticResource DangerButton}"
                            Width="110" 
                            
                            FontSize="13"
                            Padding="15,8"
                            Margin="0,0,8,8"
                            Click="RemoveParticipant_Click"/>
                    <Button Content="📄 Import CSV" 
                            Style="{StaticResource ModernButton}"
                            Width="130" 
                            
                            FontSize="13"
                            Padding="15,8"
                            Margin="0,0,8,8"
                            Click="ImportCsv_Click"/>
                    <Button Content="🗑️ Vyčistiť všetko" 
                            Style="{StaticResource SecondaryButton}"
                            Width="140" 
                            
                            FontSize="13"
                            Padding="15,8"
                            Margin="0,0,8,8"
                            Click="ClearList_Click"/>
                </WrapPanel>

                <!-- DataGrid -->
                <Border Grid.Row="1"
                        BorderThickness="1"
                        BorderBrush="{StaticResource BorderColor}"
                        CornerRadius="6"
                        Background="{StaticResource SurfaceColor}" Grid.ColumnSpan="2" Margin="0,57,0,165">
                    <DataGrid x:Name="DgParticipants"
                              Style="{StaticResource ModernDataGrid}"
                              BorderThickness="0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Meno a priezvisko" 
                                                Binding="{Binding Name}" 
                                                MinWidth="380"
                                                Width="*"/>
                            <DataGridTextColumn Header="Dátum narodenia" 
                                                Binding="{Binding BirthDate, StringFormat=dd.MM.yyyy}" 
                                                MinWidth="140"
                                                Width="*"/>
                            <DataGridTextColumn Header="Reg. číslo v komore" 
                                                Binding="{Binding RegistrationNumber}" 
                                                MinWidth="160"
                                                Width="*"/>
                            <DataGridTextColumn Header="Poznámky" 
                                                Binding="{Binding Notes}" MinWidth="220"
                                                Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
            </Grid>
        </Border>

        <!-- Statistics -->
        <Border Grid.Row="3" 
                Background="{StaticResource InputBackground}"
                CornerRadius="8"
                Padding="20,12"
                Margin="0,0,0,20">
            <StackPanel Orientation="Horizontal" 
                        HorizontalAlignment="Center">
                <TextBlock Text="👥 Účastníkov: " 
                           FontWeight="SemiBold"
                           FontSize="15"/>
                <TextBlock x:Name="TxtParticipantCount" 
                           Text="0" 
                           Foreground="{StaticResource PrimaryColor}" 
                           FontWeight="Bold"
                           FontSize="15"/>
                <TextBlock Text=" × " 
                           Margin="15,0" 
                           FontWeight="Bold"
                           FontSize="15"/>
                <TextBlock Text="📋 Tém: " 
                           FontWeight="SemiBold"
                           FontSize="15"/>
                <TextBlock x:Name="TxtTopicsCountSummary" 
                           Text="0" 
                           Foreground="{StaticResource SuccessColor}" 
                           FontWeight="Bold"
                           FontSize="15"/>
                <TextBlock Text=" = " 
                           Margin="15,0" 
                           FontWeight="Bold"
                           FontSize="15"/>
                <TextBlock Text="📄 Celkom PDF: " 
                           FontWeight="SemiBold"
                           FontSize="15"/>
                <TextBlock x:Name="TxtTotalPdfCount" 
                           Text="0" 
                           Foreground="{StaticResource DangerColor}" 
                           FontWeight="Bold" 
                           FontSize="18"/>
            </StackPanel>
        </Border>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="4" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Center">
            <Button Content="📦 Vybrať priečinok a generovať" 
                    Style="{StaticResource SuccessButton}"
                    Padding="20,10"
                    FontSize="15"
                    FontWeight="Bold"
                    Margin="0,0,15,0"
                    Click="GenerateBulkPdf_Click"/>
            <Button Content="✖️ Zavrieť" 
                    Style="{StaticResource SecondaryButton}"
                    Padding="20,10"
                    FontSize="15"
                    Click="Close_Click"/>
        </StackPanel>
    </Grid>

    </ScrollViewer>
</Window>